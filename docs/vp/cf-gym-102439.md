# 2018-2019 9th BSUIR Open Programming Championship. Semifinal

- 比赛链接：[link](https://codeforces.com/gym/102439)

- Rank 35, solved 8/12

毛子场还挺好玩的。

### A. Advertisement Matching

从后往前和从前往后可以分别推出到某个点合法的最大速度v1和v2，取min后使用小学二年级学的公式可以进行计算。复杂度$O(n)$

### B. Varvara and matrix

每行每列最多一个零，所以限制只有两种

- 不能为$A(B)$
- 不能同时为$A(B)$

这是2-SAT的形式，关键在建图。第二种限制可以简单枚举得到，第一种限制是经典的判断是否有矩形三个角为同一个数的问题，可以用bitset优化，最后复杂度$O(\frac {n^3} {\omega})$
跑合法解的时候缩环按拓扑序大的优先选择即可。

### C. Cockroach Racing

很妙的题，直接摘jiangly的题解：

$dp[l][r][i][j]$ 表示填$[l,r)$的行，$[i,m)$的列，并且第$i$ 列的所有数都 $\ge j$ 的方案数 (总和)，转移时枚举 $j$ 填到第几行，则有

$$dp[l][r][i][j]=\sum_{l\leq k\leq r}dp[l][k][i+1][0]\cdot dp[k][r][i][j+1]$$

总和的转移类似。时间复杂度 $O(10\cdot n^3m)$。

这里设的状态就很奇妙，转移也想了半天是怎么完成题目中的限制的，vandoor点拨才看到这个求和中$[l,k)$是从$i+1$列转移的，这样只需要在这一位强制比上一行大就行。

### D. Light show

没读。

### E. Small business

分类讨论

### G. Sequence exploration

打表可以发现末尾1000位存在循环节，大概从40左右开始。

### H. Nonfibonacci numbers

不含fib的子序列的数，直接做看上去没有规律，发现实际上就是不含1,2,3,5,8的数，数位DP即可。

### I. Equal Mod Segments

对于一个固定的左端点，$a_l\text{ mod }a_{l+1} \text{ mod } \cdots \text{ mod }a_r$相等的$r$只有$O(\log C)$段。所以可以用st表预处理出每个左端点往右的$\log$段和固定右端点往左的$\log$段。考虑枚举答案算对数，满足条件的区间$[i,j]$满足$L_i\leq j \leq R_i,L_j\leq i\leq R_j$，实际上是一个二维数点问题，扫描线解决即可。复杂度$O(n\log C\log n)$

### J. Boedium

好玩的题。每个人只有21种状态，即射中$0\sim 20$发子弹，这个概率是可以简单计算的。考虑枚举1号命中的子弹数，可以得到每个人名次高于1号的概率，进而算出恰好有$k$个人比ta优的概率。
复杂度$O(20^2\cdot n)$

### K. Innovations

一眼题，每条边的贡献次数就是$sz\cdot (n-sz)$，权值开根最多$\log \log C$次。开场无脑写了个树剖线段树结果T飞了，其实暴力往上跳父亲修改并计算，同时并查集合并连续的权值为1的边即可。复杂度$O(n\log \log W + m\alpha(n))$

### L. The only winner

考虑枚举两张牌是什么，求这种情况下的方案数本质上是求完美匹配的方案数。稍微画一画可以看出，当两张牌的和相等，它的答案是一样的，这样我们考虑枚举和，求每种和的方案数。（以下来自jiangly）现在假设求所有对都$\leq m$的方案数，令$l=\frac m 2$，那么$l+1\sim 2n$的每个数都匹配了$1\sim l$的某个数，剩下的任意匹配，方案数为$\frac {(m-2n)^{2n-l}(2l-2n)!}{2^{l-n}(l-n)!}$，而恰好有一对为$m+1$，其余$\leq m$的方案数为$\frac {(2n-m+l)(m-2n)^{2n-l-1}(2l-2n)!}{(l-n)!2^{l-n}}$。